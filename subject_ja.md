# C++ - モジュール 02

## アドホックポリモーフィズム、演算子オーバーロード、そして正統なカノニカルクラス形式

**概要**  
この文書は、C++ モジュールの Module 02 の演習課題を含んでいます。

**バージョン**: 8.2

---

## 目次

- I. はじめに
- II. 一般ルール
- III. 新しいルール
- IV. 演習 00: 正統カノニカル形式での最初のクラス
- V. 演習 01: より実用的な固定小数点クラスへ
- VI. 演習 02: いよいよ本番
- VII. 演習 03: BSP
- VIII. 提出とピア評価

---

## I. はじめに

C++ は、C プログラミング言語の拡張として Bjarne Stroustrup によって作成された汎用プログラミング言語です（出典: Wikipedia）。

これらのモジュールの目的は、オブジェクト指向プログラミング（OOP）を紹介することです。これはあなたの C++ の旅の出発点になります。多くの言語が OOP の学習に推奨されていますが、私たちは C++ を選びました。なぜなら、これはあなたの旧友 C に由来しているからです。この言語は複雑なので、シンプルに保つため、C++98 標準に準拠するコードを書いてください。

モダン C++ は多くの点で異なります。そのため、熟練の C++ 開発者になりたいなら、42 コモンコアの後に自分自身でさらに学ぶ必要があります。

---

## II. 一般ルール

### コンパイル

- `c++` コンパイラを使い、フラグ `-Wall -Wextra -Werror` を付けてコードをコンパイルすること。
- フラグ `-std=c++98` を付けてもコードがコンパイルできるようにしてください。

### フォーマットと命名規則

- 演習ディレクトリの命名: `ex00`, `ex01`, ..., `exn`
- ファイル、クラス、関数、メンバ関数、属性の命名はガイドラインに従うこと。
- クラス名は UpperCamelCase（例: `BrickWall`）形式で。ファイル名もそれに合わせる（例: `BrickWall.hpp`, `BrickWall.cpp`）。
- 出力メッセージは明示されない限り、必ず改行で終わること。

> Goodbye Norminette!  
> C++ モジュールではコーディングスタイルは強制されませんが、評価者が理解できないコードは採点できません。読みやすいコードを書きましょう。

### 使用可能／禁止事項

- C++ 標準ライブラリのほとんどは使用可能。
- 外部ライブラリ（Boost や C++11 以降など）は使用禁止。
- 以下の関数も禁止: `*printf()`, `*alloc()`, `free()`
- `using namespace <ns_name>` と `friend` キーワードは禁止（違反時はスコア -42）。
- STL の使用は Module 08 および 09 のみ可能（`vector`, `list`, `map`, `<algorithm>` などはそれまで禁止）。

### 設計上の注意点

- `new` を使うときはメモリリークを防ぐこと。
- Module 02〜09 では、すべてのクラスは「正統なカノニカル形式」で設計すること。
- 実装をヘッダーファイル内に書くのは禁止（テンプレート関数を除く）。
- ヘッダーファイルは独立して使用可能であるべき。依存関係を含め、`#ifndef` などのインクルードガードを追加。

---

## III. 新しいルール

今後すべてのクラスは「正統なカノニカル形式（Orthodox Canonical Form）」で設計すること（明記されている場合を除く）。以下の4つのメンバ関数を実装する必要があります：

1. デフォルトコンストラクタ  
2. コピーコンストラクタ  
3. コピー代入演算子  
4. デストラクタ  

クラスは `.hpp`（または `.h`）に定義し、`.cpp` に実装すること。

---

## IV. 演習 00: 正統カノニカル形式での最初のクラス

**ディレクトリ**: `ex00/`  
**提出物**: `Makefile`, `main.cpp`, `Fixed.{h, hpp}`, `Fixed.cpp`  
**禁止関数**: なし

### 目的：

固定小数点数を表現する「Fixed」クラスを正統カノニカル形式で作成すること。

### 実装内容：

- **プライベートメンバー**:
  - `int` 型のメンバ：固定小数点数の値
  - `static const int`: 小数点以下のビット数（常に 8）

- **パブリックメンバー**:
  - デフォルトコンストラクタ（値は 0 に初期化）
  - コピーコンストラクタ
  - コピー代入演算子
  - デストラクタ
  - `int getRawBits( void ) const`
  - `void setRawBits( int const raw )`

（省略されがちな出力例あり）

---

## V. 演習 01: より実用的な固定小数点クラスへ

**ディレクトリ**: `ex01/`  
**提出物**: `Makefile`, `main.cpp`, `Fixed.{h, hpp}`, `Fixed.cpp`  
**許可関数**: `roundf`（`<cmath>` より）

### 追加するメンバー関数：

- `Fixed( int const val )`  
- `Fixed( float const val )`  
- `float toFloat( void ) const`  
- `int toInt( void ) const`  
- `<<` 演算子オーバーロード（固定小数点 → 浮動小数点を出力）

---

## VI. 演習 02: いよいよ本番

**ディレクトリ**: `ex02/`  
**提出物**: `Makefile`, `main.cpp`, `Fixed.{h, hpp}`, `Fixed.cpp`  
**許可関数**: `roundf`（`<cmath>` より）

### 追加内容：

#### 演算子オーバーロード：

- 比較演算子6種：`>`, `<`, `>=`, `<=`, `==`, `!=`  
- 算術演算子4種：`+`, `-`, `*`, `/`  
- インクリメント／デクリメント演算子（前置・後置の両方）

#### 静的関数：

- `min( Fixed&, Fixed& )`
- `min( Fixed const&, Fixed const& )`
- `max( Fixed&, Fixed& )`
- `max( Fixed const&, Fixed const& )`

---

## VII. 演習 03: BSP

**ディレクトリ**: `ex03/`  
**提出物**: `Makefile`, `main.cpp`, `Fixed.{h, hpp}`, `Fixed.cpp`, `Point.{h, hpp}`, `Point.cpp`, `bsp.cpp`  
**許可関数**: `roundf`（`<cmath>` より）

### 目的：

三角形内に点が含まれているかどうかを判定する `bsp()` 関数を実装する。

#### `Point` クラス：

- **プライベートメンバー**:
  - `Fixed const x`
  - `Fixed const y`

- **パブリックメンバー**:
  - デフォルトコンストラクタ（x, y = 0）
  - 引数付きコンストラクタ（float 2つ）
  - コピーコンストラクタ
  - コピー代入演算子
  - デストラクタ

#### 判定関数：

```cpp
bool bsp( Point const a, Point const b, Point const c, Point const point );
````

* 三角形の頂点 `a, b, c` と、判定対象の点 `point`
* `point` が内部にあれば `true` を返す。辺または頂点上は `false`

---

## VIII. 提出とピア評価

通常通り Git リポジトリに課題を提出すること。評価中にリポジトリ外の作業は評価されません。ファイル名やディレクトリ名に誤りがないか必ず確認すること。

---

